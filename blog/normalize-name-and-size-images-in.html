<!DOCTYPE html>
<html lang="en">
<head>
          <title>datapythonista blog - Normalize name and size images in Django (and adding thumbnails)</title>
        <meta charset="utf-8" />
        <link href="https://datapythonista.github.io/blog/atom.xml" type="application/atom+xml" rel="alternate" title="datapythonista blog Full Atom Feed" />




    <meta name="tags" content="Applications" />
    <meta name="tags" content="Django" />
    <meta name="tags" content="IT" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://datapythonista.github.io/blog/">datapythonista blog <strong>about me</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li class="active"><a href="https://datapythonista.github.io/blog/category/misc.html">misc</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://datapythonista.github.io/blog/normalize-name-and-size-images-in.html" rel="bookmark"
         title="Permalink to Normalize name and size images in Django (and adding thumbnails)">Normalize name and size images in Django (and adding thumbnails)</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2007-12-10T01:19:00+00:00">
      Mon 10 December 2007
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://datapythonista.github.io/blog/author/marc.html">Marc</a>
    </address>
    <div class="category">
        Category: <a href="https://datapythonista.github.io/blog/category/misc.html">misc</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://datapythonista.github.io/blog/tag/applications.html">Applications</a>
            <a href="https://datapythonista.github.io/blog/tag/django.html">Django</a>
            <a href="https://datapythonista.github.io/blog/tag/it.html">IT</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>I wanted to assign an image to every element in a model. I wanted them to have a thumbnail, and to have normalized sizes and names. And of course, I want my application to do everything automatically.<br/><br/>The best method I've found is next, modifying models.py (note that PIL must be installed):<br/><code style="text-align: left"><br/>def rename_image(src, field, id):<br/>&nbsp;&nbsp;&nbsp;&nbsp;file_ext = os.path.splitext(src)[1].lower().replace('jpg', 'jpeg')<br/>&nbsp;&nbsp;&nbsp;&nbsp;dst = 'img/uploaded/work_%s/%s_%s%s' % (field, field, id, file_ext)<br/>&nbsp;&nbsp;&nbsp;&nbsp;return dst<br/></code><br/><br/><code style="text-align: left"><br/>def resize_image(src, dst, size):<br/>&nbsp;&nbsp;&nbsp;&nbsp;from PIL import Image<br/>&nbsp;&nbsp;&nbsp;&nbsp;image = Image.open(src)<br/>&nbsp;&nbsp;&nbsp;&nbsp;image.thumbnail(size, Image.ANTIALIAS)<br/>&nbsp;&nbsp;&nbsp;&nbsp;image.save('%s%s' % (settings.MEDIA_ROOT, dst))<br/>&nbsp;&nbsp;&nbsp;&nbsp;return dst<br/></code><br/><br/><code style="text-align: left"><br/>class MyModel(models.Model):<br/>&nbsp;&nbsp;&nbsp;&nbsp;image = models.ImageField(upload_to='img/uploaded/work_image', verbose_name=_('imagen'))<br/>&nbsp;&nbsp;&nbsp;&nbsp;thumbnail = models.ImageField(editable=False, upload_to='img/uploaded/work_thumbnail')<br/>&nbsp;&nbsp;&nbsp;&nbsp;[...]<br/></code><br/><br/><code style="text-align: left"><br/>&nbsp;&nbsp;&nbsp;&nbsp;def save(self):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(MyModel, self).save()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if self.image != rename_image(self.image, 'image', self.id):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;original_filename = self.get_image_filename()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.thumbnail = resize_image(original_filename, rename_image(original_filename, 'thumbnail', self.id), [100, 75])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.image = resize_image(original_filename, rename_image(original_filename, 'image', self.id), [640, 480])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if os.path.exists(original_filename):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.remove(original_filename)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;super(MyModel, self).save()<br/></code></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>